# mailsac
FROM ubuntu:16.04
MAINTAINER xiaofd <admin@chit.cf>

RUN sed -i "s#archive.ubuntu.com#us.archive.ubuntu.com#g" /etc/apt/sources.list

RUN apt update && \
	apt clean  && \
	apt install -y wget git --no-install-recommends && \
	apt clean && \
	rm -rf /var/lib/apt/lists/*

RUN wget -qO- https://deb.nodesource.com/setup_4.x | bash
RUN apt-get install -y nodejs && \
  git clone https://github.com/ruffrey/mailsac.git && \
  cd mailsac && \
  npm i --production
  
#apt install -y build-essential python2.7 mongodb redis-server

RUN echo "#!/bin/bash" > /mailsac/myrun.sh && \
  echo "cd /mailsac/ && /usr/bin/node app" >> /mailsac/myrun.sh && \
  chmod +x myrun.sh
	
EXPOSE 25
EXPOSE 587
EXPOSE 3000

ENTRYPOINT ["/mailsac/myrun.sh"]
